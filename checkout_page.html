<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HIGH-TECH STEEL WORKS LTD</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <img src="./gallery/Logo.jpg" alt="High-Tech Steel Works Logo" class="logo">
        <h1>High-Tech Steel Works Ltd</h1>
        <nav>
            <ul>
                <li><a href="./index.html" class="nav">Home</a></li>
                <li><a href="./products.html" class="nav">Products</a></li>
                <li><a href="./equipment.html" class="nav">Equipment</a></li>
                <li><a href="./cart_page.html" class="nav">Cart</a></li>
                <li><a href="#contacts" class="nav">Contact Us</a></li>
                <li><a href="./profile.html" class="nav">Profile</a></li>
            </ul>
        </nav>
    </header>
    <hr>

    <!-- Checkout Form -->
    <form id="checkout-form" action="https://getform.io/f/raeqkgga" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="access_key" value="fc56ca3f-a4a5-49a2-853f-758a103b34e9E">

        <label for="name"></label>
        <input type="text" id="name" name="name" placeholder="Your full names" required><br>

        <label for="address"></label>
        <input type="text" id="address" name="address" required placeholder="Delivery Address" required><br>

        <label for="email"></label>
        <input type="email" id="email" name="email" placeholder="Your email" required><br>

        <label for="phone"></label>
        <input type="tel" id="phone" name="phone" placeholder="Phone number" required><br>

        <h3>Order Summary</h3>
        <div id="order-summary">
            <!-- Order summary will be displayed here using JavaScript -->
        </div>

        <input type="hidden" name="order_details" id="order-details">
        <p>Total Price: <span id="total-checkout-price">$0.00</span></p>

        <button type="submit" onclick="confirmOrder()">Confirm Order</button>
    </form>

    <button type="button" onclick="payWithMpesa()">Pay with Mpesa</button>
    <button type="button" > <a href="./card_page.html" class=""></a> Pay with Visa</button>

    <script>
        // Retrieve or initialize cart array
        let cart = JSON.parse(localStorage.getItem('cart')) || [
            { name: "Product 1", quantity: 2, price: 10.00 },
            { name: "Product 2", quantity: 1, price: 20.00 }
        ];

        // Function to display order summary
        function initializeOrderSummary() {
            const orderSummary = document.getElementById('order-summary');
            orderSummary.innerHTML = ''; // Clear previous entries

            cart.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.textContent = `${item.name} - Quantity: ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}`;
                orderSummary.appendChild(itemDiv);
            });
            calculateTotal();
        }

        // Calculate and display total price
        function calculateTotal() {
            let total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('total-checkout-price').innerText = `$${total.toFixed(2)}`;
        }

        // Function to confirm and submit the order
        function confirmOrder() {
    const customerData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        address: document.getElementById('address').value
    };
    localStorage.setItem('customerData', JSON.stringify(customerData));

    const orderHistory = JSON.parse(localStorage.getItem('orderHistory')) || [];
    const newOrder = {
        id: orderHistory.length + 1,
        dateOrdered: new Date().toISOString().split('T')[0],
        items: cart
    };
    orderHistory.push(newOrder);
    localStorage.setItem('orderHistory', JSON.stringify(orderHistory));

    const orderDetails = cart.map(item => `${item.name} - Qty: ${item.quantity} - $${item.price}`).join(', ');
    document.getElementById('order-details').value = orderDetails;

    if (cart.length > 0) {
        document.getElementById('checkout-form').submit();
        localStorage.setItem('cart', JSON.stringify([]));
        alert('Order confirmed!');
        window.location.href = "index.html";
    } else {
        alert("Your cart is empty.");
    }
}


        // Initialize summary and total on page load
        window.onload = initializeOrderSummary;
    </script>
    <script src="scripts.js"></script> 
</body>
<footer>
    <h1><span>"Home of Experience"</span></h1>
    <div class="footer_">
        <div class="social-links">
            <h2>Location</h2>
            <p> We are loacated at Utawala,<a href="" class="social-links"></a></p>
        </div>
        <div class="social-links">
            <h2 id="contacts" class="">Contact us through:</h2>
            <a href="mailto:info@high-tech-steel-works-ltd.co.ke">Email Us |</a> 
            <a href="https://wa.me/+254724376109" aria-label="Chat with us on WhatsApp">WhatsApp Us</a> |
            <a href="tel:+254723536999" aria-label="Call High-Tech Steel Works">Call: +254 723 536 999</a>
        </div>
        <div class="social-links">
            <h2></h2>
            <img src="./gallery/Facebook.png" alt="facebook"><a href="#"> |</a> 
            <img src="./gallery/X.png" alt="facebook"><a href="#"> |</a> 
            <img src="./gallery/Tiktok.jpg" alt="facebook"><a href="#"> |</a> 
        </div>
    </div>
</footer>
</html>
